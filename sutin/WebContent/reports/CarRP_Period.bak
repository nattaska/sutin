<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="CarRP_Period" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="782" leftMargin="30" rightMargin="30" topMargin="20" bottomMargin="20">
	<property name="ireport.scriptlethandling" value="0"/>
	<property name="ireport.encoding" value="UTF-8"/>
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<import value="net.sf.jasperreports.engine.*"/>
	<import value="java.util.*"/>
	<import value="net.sf.jasperreports.engine.data.*"/>
	<reportFont name="Tahoma_Thai" isDefault="true" fontName="Tahoma" size="14" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="tahoma.ttf" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
	<parameter name="month" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["11"]]></defaultValueExpression>
	</parameter>
	<parameter name="provinceId" class="java.lang.Integer" isForPrompting="false">
		<defaultValueExpression><![CDATA[new Integer(-1)]]></defaultValueExpression>
	</parameter>
	<parameter name="SDATE" class="java.lang.String">
		<defaultValueExpression><![CDATA["01"]]></defaultValueExpression>
	</parameter>
	<parameter name="EDATE" class="java.lang.String">
		<defaultValueExpression><![CDATA["15"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select @rownum:=@rownum+1 rownum,name,tel,provincename,carmonth,license,cardate,ltype,company
from (
	select concat(ifnull(getParName(3,c.prefix),''),c.name) name,ifnull(c.tel,'-') tel,
       		ifnull(getParName(1,c.province),'-') provincename,
		ifnull(substr(l.carmonth,4,2),'') carmonth,l.license,carmonth cardate,
		ifnull(getParName(4,l.ltype),'-') ltype,
		ifnull(getParName(5,l.lcomp),'-') company
	from customer c,license l
	where c.custid=l.custid
	and l.carmonth is not null
	and l.active = 1
	and STR_TO_DATE(l.carmonth,'%d/%m/%Y') between STR_TO_DATE($P{SDATE},'%d/%m/%Y') and STR_TO_DATE($P{EDATE},'%d/%m/%Y')
	and (-1 = $P{provinceId} or c.province = $P{provinceId})
	order by substr(l.carmonth,4,2),l.license,c.name,carmonth
) cl,(SELECT @rownum:=0) r]]>
	</queryString>
	<field name="rownum" class="java.lang.Long"/>
	<field name="name" class="java.lang.String"/>
	<field name="tel" class="java.lang.String"/>
	<field name="provincename" class="java.lang.String"/>
	<field name="carmonth" class="java.lang.String"/>
	<field name="license" class="java.lang.String"/>
	<field name="cardate" class="java.lang.String"/>
	<field name="ltype" class="java.lang.String"/>
	<field name="company" class="java.lang.String"/>
	<group name="carmonth">
		<groupExpression><![CDATA[$F{carmonth}]]></groupExpression>
		<groupHeader>
			<band height="19" splitType="Stretch">
				<rectangle radius="0">
					<reportElement key="rectangle" mode="Opaque" x="0" y="0" width="782" height="17" forecolor="#000000" backcolor="#00CCCC"/>
					<graphicElement>
						<pen lineWidth="0.5" lineStyle="Solid"/>
					</graphicElement>
				</rectangle>
				<staticText>
					<reportElement key="staticText" mode="Opaque" x="0" y="0" width="96" height="15" forecolor="#000000" backcolor="#00CCCC"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Top">
						<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
					</textElement>
					<text><![CDATA[เดือน]]></text>
				</staticText>
				<textField pattern="" isBlankWhenNull="false">
					<reportElement key="textField" mode="Opaque" x="102" y="0" width="128" height="15" forecolor="#000000" backcolor="#00CCCC"/>
					<box>
						<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
						<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					</box>
					<textElement verticalAlignment="Top">
						<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
					</textElement>
					<textFieldExpression class="java.lang.String"><![CDATA[(($F{carmonth}==null||$F{carmonth}.equals(""))?"":new java.text.SimpleDateFormat("MMMMM",new java.util.Locale("th","TH")).format(new java.text.SimpleDateFormat("MM").parse($F{carmonth})))]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="10" splitType="Stretch">
				<line direction="BottomUp">
					<reportElement key="line" x="1" y="4" width="782" height="1" forecolor="#000000"/>
					<graphicElement>
						<pen lineWidth="0.5" lineStyle="Solid"/>
					</graphicElement>
				</line>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="34" splitType="Stretch">
			<line>
				<reportElement key="line" x="0" y="32" width="782" height="1" forecolor="#808080"/>
				<graphicElement>
					<pen lineWidth="2.0" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<line>
				<reportElement key="line" x="0" y="3" width="782" height="1" forecolor="#808080"/>
				<graphicElement>
					<pen lineWidth="2.0" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement key="staticText-1" x="0" y="6" width="780" height="24" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Center" lineSpacing="Single">
					<font reportFont="Tahoma_Thai" size="18"/>
				</textElement>
				<text><![CDATA[รายชื่อลูกค้าประกันรถยนต์]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="9" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="20" splitType="Stretch">
			<line direction="BottomUp">
				<reportElement key="line" x="0" y="0" width="782" height="1" forecolor="#000000"/>
				<graphicElement>
					<pen lineWidth="0.5" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<line direction="BottomUp">
				<reportElement key="line" x="0" y="19" width="782" height="1" forecolor="#000000"/>
				<graphicElement>
					<pen lineWidth="0.5" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<staticText>
				<reportElement key="staticText" x="37" y="3" width="150" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[ชื่อ]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText" x="187" y="3" width="70" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[ทะเบียนรถ]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-2" x="678" y="3" width="100" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[วันหมดอายุ]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-3" x="257" y="3" width="103" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[ประเภท]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-4" x="513" y="3" width="160" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[เบอร์โทรศัพท์]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-5" x="362" y="3" width="145" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[บริษัท]]></text>
			</staticText>
			<staticText>
				<reportElement key="staticText-6" x="2" y="3" width="34" height="17" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[ลำดับ]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="18" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="37" y="2" width="150" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new String($F{name}.getBytes("ISO8859_1"), "MS874")]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="187" y="2" width="60" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new String($F{license}.getBytes("ISO8859_1"), "MS874")]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-1" x="678" y="2" width="100" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new String($F{cardate}.getBytes("ISO8859_1"), "MS874")]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-2" x="513" y="2" width="160" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new String($F{tel}.getBytes("ISO8859_1"), "MS874")]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-3" x="2" y="2" width="28" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.Long"><![CDATA[$F{rownum}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-4" x="257" y="2" width="103" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new String($F{ltype}.getBytes("ISO8859_1"), "MS874")]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField-5" x="362" y="2" width="145" height="16" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[new String($F{company}.getBytes("ISO8859_1"), "MS874")]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="27" splitType="Stretch">
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="572" y="4" width="174" height="19" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report" pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="746" y="4" width="36" height="19" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement textAlignment="Left" verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["" + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement key="line" x="0" y="3" width="782" height="1" forecolor="#000000"/>
				<graphicElement>
					<pen lineWidth="2.0" lineStyle="Solid"/>
				</graphicElement>
			</line>
			<textField pattern="" isBlankWhenNull="false">
				<reportElement key="textField" x="1" y="6" width="209" height="19" forecolor="#000000"/>
				<box>
					<topPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<leftPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<bottomPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
					<rightPen lineWidth="0.0" lineStyle="Solid" lineColor="#000000"/>
				</box>
				<textElement verticalAlignment="Top">
					<font reportFont="Tahoma_Thai" size="10"/>
				</textElement>
				<textFieldExpression class="java.util.Date"><![CDATA[new Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
